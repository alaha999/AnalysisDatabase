#############################################
##       Database for UL analysis          ##
##    Sample, Xsec, events and Sample Lumi ##
#############################################

cross_section ={
    "HTbinnedWJets_70to100":     1271,
    "HTbinnedWJets_100to200":    1250,
    "HTbinnedWJets_200to400":    338,
    "HTbinnedWJets_400to600":    45.44,
    "HTbinnedWJets_600to800":    10.89,
    "HTbinnedWJets_800to1200":   4.93,
    "HTbinnedWJets_1200to2500":  1.157,
    "HTbinnedWJets_2500toInf":   0.02642,
    "HTbinnedWJets_Inclusive":   53450,
    "QCD_MuEnriched_15to20":     2822000,
    "QCD_MuEnriched_20to30":     2538000,
    "QCD_MuEnriched_30to50":     1369000,
    "QCD_MuEnriched_50to80":     378000,
    "QCD_MuEnriched_80to120":    89430,
    "QCD_MuEnriched_120to170":   21090,
    "QCD_MuEnriched_170to300":   7001,
    "QCD_MuEnriched_300to470":   618.9,
    "QCD_MuEnriched_470to600":   58.54,
    "QCD_MuEnriched_600to800":   18.05,
    "QCD_MuEnriched_800to1000":  3.281,
    "QCD_MuEnriched_20toInf":    523400000,
    "DYJetsToLL_M50":            6448,
    "DYJetsToLL_M10to50":        15940,
    "SingleTop_s-channel_LeptonDecays":            3.549,
    "SingleTop_t-channel_AntiTop_InclusiveDecays": 67.93,
    "SingleTop_t-channel_Top_InclusiveDecays":     113.4,
    "SingleTop_tW_AntiTop_InclusiceDecays":        32.51,
    "SingleTop_tW_Top_InclusiveDecays":            32.45,
    "TTBar_TTTo2L2Nu":           88.29,
    "TTBar_TTToSemiLeptonic":    365.34,
    "ZZ_ZZTo4L":                 1.325,
    "ZZ_ZZTo2Q2L":               3.703,
    "ZZ_ZZTo2L2Nu":              0.9738,
    "ZZ_ZZTo2Q2Nu":              4.498,
    "WZ_WZTo3LNu":               5.197,
    "WZ_WZTo2Q2L":               6.351,
    "WZ_WZTo2L2Q":               6.351,  #alias to2Q2L
    "WZ_WZTo1L1Nu2Q":            9.184,
    "WW_WWTo4Q":                 51.15,
    "WW_WWTo1L1Nu2Q":            51.14,
    "WW_WWTo2L2Nu":              11.09
}

cross_section_2016preVFP ={
    "HTbinnedWJets_70to100":     1278,
    "HTbinnedWJets_100to200":    1248,
    "HTbinnedWJets_200to400":    334.3,
    "HTbinnedWJets_400to600":    45.30,
    "HTbinnedWJets_600to800":    10.95,
    "HTbinnedWJets_800to1200":   4.928,
    "HTbinnedWJets_1200to2500":  1.157,
    "HTbinnedWJets_2500toInf":   0.02642,
    "HTbinnedWJets_Inclusive":   53710,
    "QCD_MuEnriched_15to20":     2822000,
    "QCD_MuEnriched_20to30":     2530000,
    "QCD_MuEnriched_30to50":     1366000,
    "QCD_MuEnriched_50to80":     375900,
    "QCD_MuEnriched_80to120":    88460,
    "QCD_MuEnriched_120to170":   21160,
    "QCD_MuEnriched_170to300":   7026,
    "QCD_MuEnriched_300to470":   619.7,
    "QCD_MuEnriched_470to600":   58.84,
    "QCD_MuEnriched_600to800":   18.07,
    "QCD_MuEnriched_800to1000":  3.27,
    "QCD_MuEnriched_20toInf":    523400000,
    "DYJetsToLL_M50":            6423,
    "DYJetsToLL_M10to50":        20610,
    "SingleTop_s-channel_LeptonDecays":            3.549,
    "SingleTop_t-channel_AntiTop_InclusiveDecays": 71.74,
    "SingleTop_t-channel_Top_InclusiveDecays":     113.4,
    "SingleTop_tW_AntiTop_InclusiceDecays":        32.51,
    "SingleTop_tW_Top_InclusiveDecays":            32.45,
    "TTBar_TTTo2L2Nu":           88.29,
    "TTBar_TTToSemiLeptonic":    365.34,
    "ZZ_ZZTo4L":                 1.325,
    "ZZ_ZZTo2Q2L":               3.688,
    "ZZ_ZZTo2L2Nu":              0.9738,
    "ZZ_ZZTo2Q2Nu":              4.511,
    "WZ_WZTo3LNu":               5.198,
    "WZ_WZTo2Q2L":               6.377,
    "WZ_WZTo2L2Q":               6.377,  #alias to2Q2L
    "WZ_WZTo1L1Nu2Q":            9.245,
    "WW_WWTo4Q":                 51.56,
    "WW_WWTo1L1Nu2Q":            51.31,
    "WW_WWTo2L2Nu":              11.09
}

cross_section_2016postVFP ={
    "HTbinnedWJets_70to100":     1278,
    "HTbinnedWJets_100to200":    1248,
    "HTbinnedWJets_200to400":    334.3,
    "HTbinnedWJets_400to600":    45.30,
    "HTbinnedWJets_600to800":    10.95,
    "HTbinnedWJets_800to1200":   4.928,
    "HTbinnedWJets_1200to2500":  1.157,
    "HTbinnedWJets_2500toInf":   0.02642,
    "HTbinnedWJets_Inclusive":   53710,
    "QCD_MuEnriched_15to20":     2822000,
    "QCD_MuEnriched_20to30":     2530000,
    "QCD_MuEnriched_30to50":     1366000,
    "QCD_MuEnriched_50to80":     375900,
    "QCD_MuEnriched_80to120":    88460,
    "QCD_MuEnriched_120to170":   21160,
    "QCD_MuEnriched_170to300":   7026,
    "QCD_MuEnriched_300to470":   619.7,
    "QCD_MuEnriched_470to600":   58.84,
    "QCD_MuEnriched_600to800":   18.07,
    "QCD_MuEnriched_800to1000":  3.27,
    "QCD_MuEnriched_20toInf":    523400000,
    "DYJetsToLL_M50":            6423,
    "DYJetsToLL_M10to50":        20610,
    "SingleTop_s-channel_LeptonDecays":            3.549,
    "SingleTop_t-channel_AntiTop_InclusiveDecays": 71.74,
    "SingleTop_t-channel_Top_InclusiveDecays":     113.4,
    "SingleTop_tW_AntiTop_InclusiceDecays":        32.51,
    "SingleTop_tW_Top_InclusiveDecays":            32.45,
    "TTBar_TTTo2L2Nu":           88.29,
    "TTBar_TTToSemiLeptonic":    365.34,
    "ZZ_ZZTo4L":                 1.325,
    "ZZ_ZZTo2Q2L":               3.688,
    "ZZ_ZZTo2L2Nu":              0.9738,
    "ZZ_ZZTo2Q2Nu":              4.511,
    "WZ_WZTo3LNu":               5.198,
    "WZ_WZTo2Q2L":               6.377,
    "WZ_WZTo2L2Q":               6.377,  #alias to2Q2L
    "WZ_WZTo1L1Nu2Q":            9.245,
    "WW_WWTo4Q":                 51.56,
    "WW_WWTo1L1Nu2Q":            51.31,
    "WW_WWTo2L2Nu":              11.09
}

cross_section_2017={
    "HTbinnedWJets_70to100":     1276,
    "HTbinnedWJets_100to200":    1250,
    "HTbinnedWJets_200to400":    336.4,
    "HTbinnedWJets_400to600":    44.98,
    "HTbinnedWJets_600to800":    11.03,
    "HTbinnedWJets_800to1200":   4.928,
    "HTbinnedWJets_1200to2500":  1.157,
    "HTbinnedWJets_2500toInf":   0.02642,
    "HTbinnedWJets_Inclusive":   53770,
    "QCD_MuEnriched_15to20":     2823000,
    "QCD_MuEnriched_20to30":     2530000,
    "QCD_MuEnriched_30to50":     1365000,
    "QCD_MuEnriched_50to80":     377200,
    "QCD_MuEnriched_80to120":    88290,
    "QCD_MuEnriched_120to170":   21220,
    "QCD_MuEnriched_170to300":   7070,
    "QCD_MuEnriched_300to470":   617.1,
    "QCD_MuEnriched_470to600":   59.04,
    "QCD_MuEnriched_600to800":   18.42,
    "QCD_MuEnriched_800to1000":  3.266,
    "QCD_MuEnriched_20toInf":    523400000,
    "DYJetsToLL_M50":            6448,
    "DYJetsToLL_M10to50":        15870,
    "SingleTop_s-channel_LeptonDecays":            3.549,
    "SingleTop_t-channel_AntiTop_InclusiveDecays": 67.93,
    "SingleTop_t-channel_Top_InclusiveDecays":     113.4,
    "SingleTop_tW_AntiTop_InclusiceDecays":        32.51,
    "SingleTop_tW_Top_InclusiveDecays":            32.45,
    "TTBar_TTTo2L2Nu":           88.29,
    "TTBar_TTToSemiLeptonic":    365.34,
    "ZZ_ZZTo4L":                 1.325,
    "ZZ_ZZTo2Q2L":               3.704,
    "ZZ_ZZTo2L2Nu":              0.9738,
    "ZZ_ZZTo2Q2Nu":              4.55,
    "WZ_WZTo3LNu":               5.241,
    "WZ_WZTo2Q2L":               6.449,
    "WZ_WZTo2L2Q":               6.449,  #alias to2Q2L
    "WZ_WZTo1L1Nu2Q":            9.07,
    "WW_WWTo4Q":                 51.77,
    "WW_WWTo1L1Nu2Q":            51.02,
    "WW_WWTo2L2Nu":              11.09
}

cross_section_2018 ={
    "HTbinnedWJets_70to100":     1271,
    "HTbinnedWJets_100to200":    1250,
    "HTbinnedWJets_200to400":    338,
    "HTbinnedWJets_400to600":    45.44,
    "HTbinnedWJets_600to800":    10.89,
    "HTbinnedWJets_800to1200":   4.93,
    "HTbinnedWJets_1200to2500":  1.157,
    "HTbinnedWJets_2500toInf":   0.02642,
    "HTbinnedWJets_Inclusive":   53450,
    "QCD_MuEnriched_15to20":     2822000,
    "QCD_MuEnriched_20to30":     2538000,
    "QCD_MuEnriched_30to50":     1369000,
    "QCD_MuEnriched_50to80":     378000,
    "QCD_MuEnriched_80to120":    89430,
    "QCD_MuEnriched_120to170":   21090,
    "QCD_MuEnriched_170to300":   7001,
    "QCD_MuEnriched_300to470":   618.9,
    "QCD_MuEnriched_470to600":   58.54,
    "QCD_MuEnriched_600to800":   18.05,
    "QCD_MuEnriched_800to1000":  3.281,
    "QCD_MuEnriched_20toInf":    523400000,
    "DYJetsToLL_M50":            6448,
    "DYJetsToLL_M10to50":        15940,
    "SingleTop_s-channel_LeptonDecays":            3.549,
    "SingleTop_t-channel_AntiTop_InclusiveDecays": 67.93,
    "SingleTop_t-channel_Top_InclusiveDecays":     113.4,
    "SingleTop_tW_AntiTop_InclusiceDecays":        32.51,
    "SingleTop_tW_Top_InclusiveDecays":            32.45,
    "TTBar_TTTo2L2Nu":           88.29,
    "TTBar_TTToSemiLeptonic":    365.34,
    "ZZ_ZZTo4L":                 1.325,
    "ZZ_ZZTo2Q2L":               3.703,
    "ZZ_ZZTo2L2Nu":              0.9738,
    "ZZ_ZZTo2Q2Nu":              4.498,
    "WZ_WZTo3LNu":               5.197,
    "WZ_WZTo2Q2L":               6.351,
    "WZ_WZTo2L2Q":               6.351,  #alias to2Q2L
    "WZ_WZTo1L1Nu2Q":            9.184,
    "WW_WWTo4Q":                 51.15,
    "WW_WWTo1L1Nu2Q":            51.14,
    "WW_WWTo2L2Nu":              11.09
}

TotalEvents_2018 ={
    "HTbinnedWJets_70to100":    66220256,
    "HTbinnedWJets_100to200":   51408967,
    "HTbinnedWJets_200to400":   58225632,
    "HTbinnedWJets_400to600":   7444030,
    "HTbinnedWJets_600to800":   7718756,
    "HTbinnedWJets_800to1200":  7306187,
    "HTbinnedWJets_1200to2500": 6481518,
    "HTbinnedWJets_2500toInf":  2097648,
    "HTbinnedWJets_Inclusive":  81051269,
    "QCD_MuEnriched_20to30":    60640516,
    "QCD_MuEnriched_30to50":    58737695,
    "QCD_MuEnriched_50to80":    40022458,
    "QCD_MuEnriched_80to120":   45494357,
    "QCD_MuEnriched_120to170":  38022194,
    "QCD_MuEnriched_170to300":  71870974,
    "QCD_MuEnriched_300to470":  58949756,
    "QCD_MuEnriched_470to600":  38453296,
    "QCD_MuEnriched_600to800":  37197942,
    "QCD_MuEnriched_800to1000": 37197942,
    "QCD_MuEnriched_20toInf":   17392472,
    "DYJetsToLL_M50":           195510810,
    "DYJetsToLL_M10to50":       94452816,
    "SingleTop_s-channel_LeptonDecays":            19365999,
    "SingleTop_t-channel_AntiTop_InclusiveDecays": 95627000,
    "SingleTop_t-channel_Top_InclusiveDecays":     178336000,
    "SingleTop_tW_AntiTop_InclusiceDecays":        7749000,
    "SingleTop_tW_Top_InclusiveDecays":            7956000,
    "TTBar_TTTo2L2Nu":          145020000,
    "TTBar_TTToSemiLeptonic":   476408000,
    "ZZ_ZZTo4L":                98488000,
    "ZZ_ZZTo2Q2L":              29357938,
    "ZZ_ZZTo2L2Nu":             56886000,
    "ZZ_ZZTo2Q2Nu":             19813764,
    "WZ_WZTo3LNu":              9821283,
    "WZ_WZTo2Q2L":              28576996,
    "WZ_WZTo1L1Nu2Q":           7395487,
    "WW_WWTo4Q":                39541500,
    "WW_WWTo1L1Nu2Q":           40272013,
    "WW_WWTo2L2Nu":             9994000,
    "SingleMuon_SingleMuon_A":  241608232,
    "SingleMuon_SingleMuon_B":  119918017,
    "SingleMuon_SingleMuon_C":  109986009,
    "SingleMuon_SingleMuon_D":  513909894
}

TotalEvents_2017 ={
    "HTbinnedWJets_70to100":    66220256,
    "HTbinnedWJets_100to200":   51408967,
    "HTbinnedWJets_200to400":   58225632,
    "HTbinnedWJets_400to600":   7444030,
    "HTbinnedWJets_600to800":   7718765,
    "HTbinnedWJets_800to1200":  7306187,
    "HTbinnedWJets_1200to2500": 6481518,
    "HTbinnedWJets_2500toInf":  2097648,
    "HTbinnedWJets_Inclusive":  78307186,
    "QCD_MuEnriched_20to30":    64623134,
    "QCD_MuEnriched_30to50":    58639613,
    "QCD_MuEnriched_50to80":    40322726,
    "QCD_MuEnriched_80to120":   45981017,
    "QCD_MuEnriched_120to170":  39394151,
    "QCD_MuEnriched_170to300":  73071987,
    "QCD_MuEnriched_300to470":  58692910,
    "QCD_MuEnriched_470to600":  39491752,
    "QCD_MuEnriched_600to800":  39321940,
    "QCD_MuEnriched_800to1000": 78215559,
    "QCD_MuEnriched_20toInf":   17392472,
    "DYJetsToLL_M50":           195529774,
    "DYJetsToLL_M10to50":       68480179,
    "SingleTop_s-channel_LeptonDecays":            13620000,
    "SingleTop_t-channel_AntiTop_InclusiveDecays": 69793000,
    "SingleTop_t-channel_Top_InclusiveDecays":     129903000,
    "SingleTop_tW_AntiTop_InclusiceDecays":        5649000,
    "SingleTop_tW_Top_InclusiveDecays":            5674000,
    "TTBar_TTTo2L2Nu":          106724000,
    "TTBar_TTToSemiLeptonic":   346052000,
    "ZZ_ZZTo4L":                99388000,
    "ZZ_ZZTo2Q2L":              29521496,
    "ZZ_ZZTo2L2Nu":             40839000,
    "ZZ_ZZTo2Q2Nu":             4934394,
    "WZ_WZTo3LNu":              10339582,
    "WZ_WZTo2Q2L":              29091996,
    "WZ_WZTo1L1Nu2Q":           7345742,
    "WZ_WZTo2L2Q":              29091996,
    "WW_WWTo4Q":                39443728,
    "WW_WWTo1L1Nu2Q":           39931603,
    "WW_WWTo2L2Nu":             7098000,
    "SingleMuon_SingleMuon_B":  136300266,
    "SingleMuon_SingleMuon_C":  165652756,
    "SingleMuon_SingleMuon_D":  70361660,
    "SingleMuon_SingleMuon_E":  154618774,
    "SingleMuon_SingleMuon_F":  242140980,
}

TotalEvents_2016preVFP ={
    "HTbinnedWJets_70to100":    16931765,
    "HTbinnedWJets_100to200":   21734530,
    "HTbinnedWJets_200to400":   17870845,
    "HTbinnedWJets_400to600":   2467498,
    "HTbinnedWJets_600to800":   2344130,
    "HTbinnedWJets_800to1200":  2510487,
    "HTbinnedWJets_1200to2500": 0,
    "HTbinnedWJets_2500toInf":  0,
    "HTbinnedWJets_Inclusive":  74060701,
    "QCD_MuEnriched_15to20":    4749558,
    "QCD_MuEnriched_20to30":    31926643,
    "QCD_MuEnriched_30to50":    28664840,
    "QCD_MuEnriched_50to80":    19724658,
    "QCD_MuEnriched_80to120":   21978558,
    "QCD_MuEnriched_120to170":  19136907,
    "QCD_MuEnriched_170to300":  37080544,
    "QCD_MuEnriched_300to470":  28465385,
    "QCD_MuEnriched_470to600":  19695298,
    "QCD_MuEnriched_600to800":  19598815,
    "QCD_MuEnriched_800to1000": 389333940,
    "QCD_MuEnriched_20toInf":   0,
    "DYJetsToLL_M50":           90947213,
    "DYJetsToLL_M10to50":       49632553,
    "SingleTop_s-channel_LeptonDecays":            5518000,
    "SingleTop_t-channel_AntiTop_InclusiveDecays": 24681000,
    "SingleTop_t-channel_Top_InclusiveDecays":     55961000,
    "SingleTop_tW_AntiTop_InclusiceDecays":        2300000,
    "SingleTop_tW_Top_InclusiveDecays":            2300000,
    "TTBar_TTTo2L2Nu":          37505000,
    "TTBar_TTToSemiLeptonic":   132178000,
    "ZZ_ZZTo4L":                49691000,
    "ZZ_ZZTo2Q2L":              16060738,
    "ZZ_ZZTo2L2Nu":             16862000,
    "ZZ_ZZTo2Q2Nu":             2468069,
    "WZ_WZTo3LNu":              9633623,
    "WZ_WZTo2Q2L":              15678816,
    "WZ_WZTo1L1Nu2Q":           3690271,
    "WZ_WZTo2L2Q":              15678816,
    "WW_WWTo4Q":                19599397,
    "WW_WWTo1L1Nu2Q":           20071678,
    "WW_WWTo2L2Nu":             3018000,
    "SingleMuon_SingleMuon_B":  158145722,
    "SingleMuon_SingleMuon_C":  67441308,
    "SingleMuon_SingleMuon_D":  98017996,
    "SingleMuon_SingleMuon_E":  90984718,
    "SingleMuon_SingleMuon_F":  57465359,
}



def makeTextFile(year,eventdict):
    textfile = open(f'database_{year}.txt','w')
    textfile.write(f"{'SAMPLE':<50}\t{'XSEC':^10}\t{'EVENTS':10}\t{'LUMI'}\n\n")
    for key in eventdict.keys():
        try:
            events = eventdict[key]
            xsec   = cross_section[key]
            lumi   = events/xsec #inpb
            Line   =f"{key:<50}\t{xsec:^10}\t{events:^10}\t{lumi:.3f}\n"
        except KeyError:
            events = eventdict.get(key)
            xsec   = 'unknown'
            lumi   = 'unknown'
            Line   =f"{key:<50}\t{xsec:^10}\t{events:^10}\t{lumi}\n"
        
        textfile.write(Line)


def makeCrossSecTextFile():
    Xsecfile = open(f'crosssection_db.txt','w')
    Xsecfile.write(f"{'SAMPLE':<45}\t{'XSEC':^10}\t{'(2016preVFP)':^10}\t{'(2016postVFP)':^10}\t{'(2017)':^10}\t{'(2018)':^10}\n\n")

    for key in cross_section.keys():
        Xsec_2016preVFP  = cross_section_2016preVFP.get(key)
        Xsec_2016postVFP = cross_section_2016postVFP.get(key)
        Xsec_2017        = cross_section_2017.get(key)
        Xsec_2018        = cross_section_2018.get(key)
        Xsec_analysis    = cross_section.get(key)
        
        Line =f"{key:<45}\t{Xsec_analysis:^10}\t{Xsec_2016preVFP:^10}\t{Xsec_2016postVFP:^10}\t{Xsec_2017:^10}\t{Xsec_2018:^10}\n"
        Xsecfile.write(Line)
#--------------------------------------------------------------------
makeTextFile('2018',TotalEvents_2018)
makeTextFile('2017',TotalEvents_2017)
makeTextFile('2016preVFP',TotalEvents_2016preVFP)

makeCrossSecTextFile()  ## produce text file comparing Xsec across eras

