#include <vector>
#include "TMath.h"
#include "btagScaleFactor.h"
using namespace std;

// bTag SF for the event (looped over all jets)
// For "data" efficiency, enter the stored JetDeepMediumCSVSF value
// For "mc" efficiency, enter JetDeepMediumCSVSF as 1.0 !!

// ------------------------------------------------------------------------------------------
// ------------------------------------------------------------------------------------------


// 2018
float VLLAna::btagsf2018 (int MCsample, vector<Lepton>Jet){

  // bogus default values
  float probability_mc = 1.0;
  float probability_data = 1.0;
  float LJetEff[3][8] = { {  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5   }, {  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5   }, {  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5   } };
  float CJetEff[3][8] = { {  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5   }, {  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5   }, {  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5   } };
  float BJetEff[3][8] = { {  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5   }, {  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5   }, {  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5   } };
  //
  // ----------------------
  //DY(1-9)
  if( MCsample == 1 ) {
    float BJetEff_temp[3][8] = {{0.7413793206214905, 0.7703523635864258, 0.8255318999290466, 0.8030303120613098, 0.7920792102813721, 0.65625, 0.3333333432674408, 0.0}, {0.6963824033737183, 0.7422680258750916, 0.7375690340995789, 0.7814569473266602, 0.7592592835426331, 0.6086956262588501, 0.75, 0.0}, {0.6778656244277954, 0.6961038708686829, 0.6722689270973206, 0.7263157963752747, 0.7575757503509521, 0.699999988079071, 0.3333333432674408, 0.0}};
    float CJetEff_temp[3][8] = {{0.1325663924217224, 0.13635194301605225, 0.14884980022907257, 0.17954544723033905, 0.13927575945854187, 0.09420289844274521, 0.2368421107530594, 0.0}, {0.13923883438110352, 0.1513879895210266, 0.1701408475637436, 0.1639118492603302, 0.17204301059246063, 0.13913042843341827, 0.12903225421905518, 0.0}, {0.15341998636722565, 0.15605977177619934, 0.1506996750831604, 0.18285714089870453, 0.09929078072309494, 0.09756097197532654, 0.5, 0.0}};
    float LJetEff_temp[3][8] = {{0.006256819237023592, 0.005256718024611473, 0.007870947942137718, 0.008578207343816757, 0.010438413359224796, 0.006211180239915848, 0.013245033100247383, 0.0}, {0.010501924902200699, 0.009595475159585476, 0.008990745060145855, 0.010550268925726414, 0.007494145072996616, 0.01272264588624239, 0.019138755276799202, 0.0}, {0.017586354166269302, 0.013942408375442028, 0.015332411974668503, 0.014531435444951057, 0.02123142220079899, 0.008456659503281116, 0.009345794096589088, 0.0}};
      
    for ( int i=0; i<3; i++) {
      for ( int j=0; j<8; j++) {
	BJetEff[i][j] = LJetEff_temp[i][j];
	CJetEff[i][j] = CJetEff_temp[i][j];
	LJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
  else if ( MCsample == 2 ) { //DY_M50
    float BJetEff_temp[3][8] = {{0.7264552712440491, 0.7623830437660217, 0.7770060300827026, 0.7907560467720032, 0.7791628837585449, 0.7413303256034851, 0.6608455777168274, 0.550000011920929}, {0.7093466520309448, 0.7429766654968262, 0.7552801370620728, 0.7557049989700317, 0.7263410687446594, 0.6919274926185608, 0.5664652585983276, 0.4137931168079376}, {0.6772063374519348, 0.7044256925582886, 0.7058749794960022, 0.6875594854354858, 0.6412832140922546, 0.5927152037620544, 0.5654450058937073, 0.0}};
    float CJetEff_temp[3][8] = {{0.12354467064142227, 0.12548303604125977, 0.13659244775772095, 0.15189872682094574, 0.16271944344043732, 0.159993976354599, 0.13863538205623627, 0.12837837636470795}, {0.13458386063575745, 0.1336909383535385, 0.14625763893127441, 0.1541878879070282, 0.161415696144104, 0.14792050421237946, 0.12800519168376923, 0.014705882407724857}, {0.14287269115447998, 0.14478832483291626, 0.14374102652072906, 0.15048100054264069, 0.15143078565597534, 0.137783482670784, 0.11702127754688263, 0.1538461595773697}};
    float LJetEff_temp[3][8] = {{0.009431243874132633, 0.008685927838087082, 0.009041663259267807, 0.009903737343847752, 0.011737569235265255, 0.013528977520763874, 0.017319276928901672, 0.02108626253902912}, {0.013891812413930893, 0.012897375971078873, 0.013311809860169888, 0.013911813497543335, 0.01477238442748785, 0.01628826931118965, 0.01963832415640354, 0.015447991900146008}, {0.020311523228883743, 0.018923891708254814, 0.019228167831897736, 0.020086096599698067, 0.021200863644480705, 0.023129640147089958, 0.02634895220398903, 0.0260869562625885}};
            
    for ( int i=0; i<3 ; i++) {
      for ( int j=0; j<8; j++) {
	LJetEff[i][j] = LJetEff_temp[i][j];
	CJetEff[i][j] = CJetEff_temp[i][j];
	BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
  
  //QCD_MuEnriched(10-20)
  else if ( MCsample == 10 ) { //QCD_20to30
    float BJetEff_temp[3][8] = {{0.7083947062492371, 0.8421052694320679, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0}, {0.6867671608924866, 0.6363636255264282, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.6577017307281494, 0.6296296119689941, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}};
    float CJetEff_temp[3][8] = {{0.12793733179569244, 0.17391304671764374, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.16368286311626434, 0.13636364042758942, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.1609589010477066, 0.1111111119389534, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}};
    float LJetEff_temp[3][8] = {{0.009413067251443863, 0.01582278497517109, 0.0731707289814949, 0.05263157933950424, 0.0, 0.5, 0.0, 0.0}, {0.017635712400078773, 0.026229508221149445, 0.08064515888690948, 0.1111111119389534, 0.0, 0.0, 0.0, 0.0}, {0.021357519552111626, 0.01606425642967224, 0.05263157933950424, 0.0, 0.0, 0.0, 0.0, 0.0}};
            
    for ( int i=0; i<3 ; i++) {
      for ( int j=0; j<8; j++) {
	LJetEff[i][j] = LJetEff_temp[i][j];
	CJetEff[i][j] = CJetEff_temp[i][j];
	BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
  else if ( MCsample == 11 ) { // QCD_30to50
    float BJetEff_temp[3][8] = {{0.7333512902259827, 0.7868155241012573, 0.8279221057891846, 0.625, 0.0, 0.0, 0.0, 0.0}, {0.7198282480239868, 0.7494962811470032, 0.7914893627166748, 0.4444444477558136, 0.0, 1.0, 0.0, 0.0}, {0.6949670910835266, 0.742290735244751, 0.7280701994895935, 0.6666666865348816, 0.0, 0.0, 0.0, 0.0}};
    float CJetEff_temp[3][8] = {{0.13325642049312592, 0.14501892030239105, 0.1944444477558136, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.15161582827568054, 0.14603616297245026, 0.12030075490474701, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.15807826817035675, 0.18503937125205994, 0.0833333358168602, 0.0, 0.0, 0.0, 0.0, 0.0}};
    float LJetEff_temp[3][8] = {{0.0071444036439061165, 0.00699300691485405, 0.00975081231445074, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.010358477011322975, 0.008131584152579308, 0.008648648858070374, 0.0, 0.0, 0.0, 0.0, 0.0}, {0.01791924051940441, 0.01591160148382187, 0.01484480407088995, 0.05263157933950424, 0.0, 0.0, 0.0, 0.0}};
            
    for ( int i=0; i<3 ; i++) {
      for ( int j=0; j<8; j++) {
	LJetEff[i][j] = LJetEff_temp[i][j];
	CJetEff[i][j] = CJetEff_temp[i][j];
	BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
  else if ( MCsample == 12 ) { // QCD_50to80
    float BJetEff_temp[3][8] = {{0.7534525990486145, 0.7805356979370117, 0.8116064071655273, 0.829959511756897, 0.9375, 0.0, 0.0, 0.0}, {0.7229890823364258, 0.7752847075462341, 0.7854597568511963, 0.7867646813392639, 0.6666666865348816, 0.0, 0.0, 0.0}, {0.699103057384491, 0.7187584638595581, 0.7514758110046387, 0.758474588394165, 0.8571428656578064, 0.0, 0.0, 0.0}};
    float CJetEff_temp[3][8] ={{0.1294238269329071, 0.14374610781669617, 0.14924506843090057, 0.1672862470149994, 0.0, 0.0, 0.0, 0.0}, {0.15143699944019318, 0.16187433898448944, 0.1627747267484665, 0.18571428954601288, 0.1428571492433548, 0.0, 0.0, 0.0}, {0.14772182703018188, 0.16070599853992462, 0.15643563866615295, 0.26451611518859863, 0.1666666716337204, 0.0, 0.0, 0.0}};
    float LJetEff_temp[3][8] = {{0.0077225565910339355, 0.0066029843874275684, 0.00570638058707118, 0.009413067251443863, 0.01315789483487606, 0.0, 0.0, 0.0}, {0.011758077889680862, 0.008757627569139004, 0.008676182478666306, 0.007656065747141838, 0.014705882407724857, 0.0, 0.0, 0.0}, {0.018907444551587105, 0.01687919907271862, 0.017340363934636116, 0.0235294122248888, 0.0, 0.0, 0.0, 0.0}};
            
    for ( int i=0; i<3 ; i++) {
      for ( int j=0; j<8; j++) {
	LJetEff[i][j] = LJetEff_temp[i][j];
	CJetEff[i][j] = CJetEff_temp[i][j];
	BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
  else if ( MCsample == 13 ) { //QCD_80to120
    float BJetEff_temp[3][8] = {{0.7483575344085693, 0.7721542716026306, 0.800000011920929, 0.8214484453201294, 0.8530510663986206, 0.8333333134651184, 0.0, 0.0}, {0.7287436723709106, 0.7576857209205627, 0.7767677903175354, 0.7805917263031006, 0.7929984927177429, 0.7647058963775635, 0.0, 0.0}, {0.684878408908844, 0.7090938091278076, 0.7108837366104126, 0.7227310538291931, 0.7335329055786133, 0.7142857313156128, 0.0, 0.0}};
    float CJetEff_temp[3][8] = {{0.13935230672359467, 0.14724324643611908, 0.15336290001869202, 0.17531797289848328, 0.19961240887641907, 0.4166666567325592, 0.0, 0.0}, {0.15347306430339813, 0.16006486117839813, 0.1605224311351776, 0.1809363067150116, 0.18465228378772736, 0.09090909361839294, 0.0, 0.0}, {0.1704467386007309, 0.15204113721847534, 0.17274583876132965, 0.18014705181121826, 0.19148936867713928, 0.3333333432674408, 0.0, 0.0}};
    float LJetEff_temp[3][8] = {{0.00864409375935793, 0.008455674163997173, 0.00759861757978797, 0.008717762306332588, 0.01156240701675415, 0.0, 0.0, 0.0}, {0.013982429169118404, 0.013342770747840405, 0.012109247967600822, 0.009892970323562622, 0.01046435534954071, 0.01886792480945587, 0.0, 0.0}, {0.020711302757263184, 0.019687367603182793, 0.01910005509853363, 0.018207184970378876, 0.01928640343248844, 0.04615384712815285, 0.0, 0.0}};
            
    for ( int i=0; i<3 ; i++) {
      for ( int j=0; j<8; j++) {
	LJetEff[i][j] = LJetEff_temp[i][j];
	CJetEff[i][j] = CJetEff_temp[i][j];
	BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
  else if ( MCsample == 14 ) { //QCD_120to170
    float BJetEff_temp[3][8] = {{0.7383577823638916, 0.7628954648971558, 0.7826714515686035, 0.7936267256736755, 0.802428662776947, 0.8098360896110535, 0.875, 0.0}, {0.7290050387382507, 0.7485443949699402, 0.7563943266868591, 0.7539482712745667, 0.7501266002655029, 0.7995226979255676, 0.5, 0.0}, {0.6816418170928955, 0.7018140554428101, 0.6887310743331909, 0.6799060106277466, 0.6788894534111023, 0.6000000238418579, 0.0, 0.0}};
    float CJetEff_temp[3][8] = {{0.1519080251455307, 0.14416058361530304, 0.17262376844882965, 0.17154638469219208, 0.1875637173652649, 0.21227622032165527, 0.4285714328289032, 0.0}, {0.1634666621685028, 0.15645472705364227, 0.1716027855873108, 0.1773262470960617, 0.17706237733364105, 0.20000000298023224, 0.3333333432674408, 0.0}, {0.16068190336227417, 0.1618996262550354, 0.1557788997888565, 0.1559043824672699, 0.15174825489521027, 0.15000000596046448, 0.20000000298023224, 0.0}};
    float LJetEff_temp[3][8] = {{0.010162169113755226, 0.011166253127157688, 0.01108288113027811, 0.011127523146569729, 0.011385099962353706, 0.011448875069618225, 0.0, 0.0}, {0.016246793791651726, 0.016325335949659348, 0.01715233363211155, 0.014385368674993515, 0.012695824727416039, 0.009316770359873772, 0.03703703731298447, 0.0}, {0.02379879541695118, 0.020944345742464066, 0.024231400340795517, 0.02397274598479271, 0.021731283515691757, 0.02024584263563156, 0.0, 0.0}};
            
    for ( int i=0; i<3 ; i++) {
      for ( int j=0; j<8; j++) {
	LJetEff[i][j] = LJetEff_temp[i][j];
	CJetEff[i][j] = CJetEff_temp[i][j];
	BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
  else if ( MCsample == 15 ) { //QCD_170to300
    float BJetEff_temp[3][8] = {{0.7391226291656494, 0.7673273682594299, 0.7818244695663452, 0.7735652923583984, 0.7800326943397522, 0.7659652829170227, 0.7171398401260376, 0.0}, {0.7192861437797546, 0.7508823275566101, 0.7587626576423645, 0.7313567996025085, 0.72701495885849, 0.7022373080253601, 0.6213183999061584, 0.0}, {0.6814292073249817, 0.704741358757019, 0.6884673833847046, 0.6788942217826843, 0.6321331858634949, 0.5801056623458862, 0.5505050420761108, 0.0}};
    float CJetEff_temp[3][8] = {{0.15179131925106049, 0.15254640579223633, 0.16381314396858215, 0.17458412051200867, 0.19021522998809814, 0.17815512418746948, 0.1604621261358261, 0.0}, {0.17601646482944489, 0.16432051360607147, 0.16727448999881744, 0.193689227104187, 0.17870403826236725, 0.17802682518959045, 0.14938488602638245, 0.0}, {0.16603054106235504, 0.1641910821199417, 0.1562156230211258, 0.1795027256011963, 0.169270321726799, 0.1562073677778244, 0.14537444710731506, 0.0}};
    float LJetEff_temp[3][8] = {{0.012265472672879696, 0.012131295166909695, 0.014266258105635643, 0.015599866397678852, 0.014759057201445103, 0.012982389889657497, 0.014690879732370377, 0.0}, {0.017334407195448875, 0.01702014170587063, 0.018915845081210136, 0.02042989246547222, 0.01827586255967617, 0.016594190150499344, 0.01617891900241375, 0.0}, {0.023440096527338028, 0.026175890117883682, 0.026698535308241844, 0.03096696361899376, 0.027525952085852623, 0.025761617347598076, 0.02633851394057274, 0.0}};
            
    for ( int i=0; i<3 ; i++) {
      for ( int j=0; j<8; j++) {
	LJetEff[i][j] = LJetEff_temp[i][j];
	CJetEff[i][j] = CJetEff_temp[i][j];
	BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
  else if ( MCsample == 16 ) { //QCD_300to470
    float BJetEff_temp[3][8] = {{0.7307289242744446, 0.7797377705574036, 0.7785219550132751, 0.769760251045227, 0.7621533870697021, 0.7225766181945801, 0.6670488715171814, 0.4444444477558136}, {0.71726393699646, 0.7418922781944275, 0.759579062461853, 0.7270106673240662, 0.7124716639518738, 0.6493520140647888, 0.5977216958999634, 0.4166666567325592}, {0.6921426653862, 0.7134632468223572, 0.7203931212425232, 0.6696270108222961, 0.6083537936210632, 0.5596307516098022, 0.4836065471172333, 0.3333333432674408}};
    float CJetEff_temp[3][8] = {{0.15238313376903534, 0.14956456422805786, 0.17578710615634918, 0.1892816424369812, 0.1873043030500412, 0.1842477172613144, 0.16246850788593292, 0.04477611929178238}, {0.17042474448680878, 0.1587091088294983, 0.16552609205245972, 0.18975068628787994, 0.18560467660427094, 0.17001675069332123, 0.14401650428771973, 0.20930232107639313}, {0.17203019559383392, 0.18732590973377228, 0.16124260425567627, 0.16477273404598236, 0.152531236410141, 0.15054433047771454, 0.11888321489095688, 0.0}};
    float LJetEff_temp[3][8] = {{0.014098690822720528, 0.012757462449371815, 0.013661202043294907, 0.018394852057099342, 0.022764405235648155, 0.020346762612462044, 0.018067779019474983, 0.021276595070958138}, {0.019901791587471962, 0.017354195937514305, 0.01943857967853546, 0.02263256162405014, 0.024323638528585434, 0.023857779800891876, 0.020942000672221184, 0.01923076994717121}, {0.02566882222890854, 0.024570023640990257, 0.02576754428446293, 0.02897617593407631, 0.03463243320584297, 0.036089614033699036, 0.02789812721312046, 0.0555555559694767}};
            
    for ( int i=0; i<3 ; i++) {
      for ( int j=0; j<8; j++) {
	LJetEff[i][j] = LJetEff_temp[i][j];
	CJetEff[i][j] = CJetEff_temp[i][j];
	BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
  else if ( MCsample == 17 ) { //QCD_470to600
    float BJetEff_temp[3][8] = {{0.7340093851089478, 0.7824490070343018, 0.7794768810272217, 0.7798208594322205, 0.7650453448295593, 0.7126670479774475, 0.609829843044281, 0.46833184361457825}, {0.7250075936317444, 0.7399905920028687, 0.7396449446678162, 0.7549549341201782, 0.6963755488395691, 0.6414934396743774, 0.5184996724128723, 0.39600664377212524}, {0.6950457096099854, 0.7050730586051941, 0.7073625326156616, 0.6666666865348816, 0.6380027532577515, 0.5646766424179077, 0.42415425181388855, 0.3461538553237915}};
    float CJetEff_temp[3][8] = {{0.15627165138721466, 0.15692821145057678, 0.17780360579490662, 0.1722428798675537, 0.2098623812198639, 0.2011784464120865, 0.14227020740509033, 0.0954907163977623}, {0.17270788550376892, 0.18110795319080353, 0.16440314054489136, 0.16680429875850677, 0.19020867347717285, 0.16395284235477448, 0.1287851184606552, 0.10370370000600815}, {0.17606602609157562, 0.16550925374031067, 0.19926199316978455, 0.1990811675786972, 0.16363635659217834, 0.14266487956047058, 0.10494016855955124, 0.09150326997041702}};
    float LJetEff_temp[3][8] = {{0.013953129760921001, 0.012751629576086998, 0.015282287262380123, 0.015400703065097332, 0.019207920879125595, 0.02386438474059105, 0.021115494892001152, 0.017882971093058586}, {0.019338127225637436, 0.016879482194781303, 0.01924215443432331, 0.018594050779938698, 0.019423481076955795, 0.02632378228008747, 0.026848256587982178, 0.022377168759703636}, {0.025006331503391266, 0.023974845185875893, 0.02436053566634655, 0.02878548949956894, 0.031770046800374985, 0.0321706123650074, 0.03479482978582382, 0.01840490847826004}};
            
    for ( int i=0; i<3 ; i++) {
      for ( int j=0; j<8; j++) {
	LJetEff[i][j] = LJetEff_temp[i][j];
	CJetEff[i][j] = CJetEff_temp[i][j];
	BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
  else if ( MCsample == 18 ) { //QCD_600to800
    float BJetEff_temp[3][8] = {{0.7330688834190369, 0.7668463587760925, 0.7752110362052917, 0.7781139612197876, 0.7536820769309998, 0.703459620475769, 0.5759894251823425, 0.4640258550643921}, {0.711449384689331, 0.7410810589790344, 0.7436801791191101, 0.751366138458252, 0.6987087726593018, 0.619140625, 0.49544864892959595, 0.38245338201522827}, {0.7037037014961243, 0.7264705896377563, 0.719393253326416, 0.6738505959510803, 0.6495726704597473, 0.5815450549125671, 0.38736262917518616, 0.264970064163208}};
    float CJetEff_temp[3][8] = {{0.145340234041214, 0.1655426174402237, 0.17144563794136047, 0.20571057498455048, 0.2070484608411789, 0.1939203292131424, 0.13613200187683105, 0.09116503596305847}, {0.16982024908065796, 0.16393442451953888, 0.18773946166038513, 0.1791469156742096, 0.18798956274986267, 0.16383308172225952, 0.12547169625759125, 0.0725400447845459}, {0.1500742882490158, 0.148793563246727, 0.1649928241968155, 0.18525180220603943, 0.16067653894424438, 0.1629464328289032, 0.08812949806451797, 0.0618145577609539}};
    float LJetEff_temp[3][8] = {{0.013784606009721756, 0.012345679104328156, 0.014917083084583282, 0.015958469361066818, 0.018501387909054756, 0.01909307949244976, 0.02724512852728367, 0.018337910994887352}, {0.01870795339345932, 0.017940077930688858, 0.016502665355801582, 0.016356315463781357, 0.021744966506958008, 0.01997128315269947, 0.031650613993406296, 0.021788325160741806}, {0.02456902340054512, 0.023550979793071747, 0.028228532522916794, 0.02476780116558075, 0.02865329571068287, 0.027378693222999573, 0.03430924192070961, 0.020926129072904587}};
            
    for ( int i=0; i<3 ; i++) {
      for ( int j=0; j<8; j++) {
	LJetEff[i][j] = LJetEff_temp[i][j];
	CJetEff[i][j] = CJetEff_temp[i][j];
	BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
  else if ( MCsample == 19 ) { //QCD_800to1200
    float BJetEff_temp[3][8] = {{0.7295399308204651, 0.7696152925491333, 0.7720791697502136, 0.7935847043991089, 0.7645161151885986, 0.7227044105529785, 0.582685112953186, 0.397755891084671}, {0.7343205809593201, 0.7533607482910156, 0.7628481388092041, 0.7471423745155334, 0.7203897833824158, 0.6683842539787292, 0.49515417218208313, 0.32471221685409546}, {0.6894392371177673, 0.7031853199005127, 0.7135733962059021, 0.707561731338501, 0.6531049013137817, 0.5661861300468445, 0.4273339807987213, 0.25969961285591125}};
    float CJetEff_temp[3][8] = {{0.15162643790245056, 0.17402449250221252, 0.1711864471435547, 0.1778680831193924, 0.1878250241279602, 0.17654915153980255, 0.14777618646621704, 0.08047401905059814}, {0.1656600534915924, 0.17425373196601868, 0.17983326315879822, 0.1882563829421997, 0.20456580817699432, 0.16303865611553192, 0.13006111979484558, 0.06328187137842178}, {0.16765578091144562, 0.18158236145973206, 0.18302017450332642, 0.19641171395778656, 0.17918455600738525, 0.1668773740530014, 0.12088815867900848, 0.05906148999929428}};
    float LJetEff_temp[3][8] = {{0.014078991487622261, 0.013480803929269314, 0.01285761408507824, 0.016651825979351997, 0.017161432653665543, 0.01888909749686718, 0.025810224935412407, 0.018290799111127853}, {0.019778357818722725, 0.015764988958835602, 0.017429722473025322, 0.019043562933802605, 0.017531845718622208, 0.01971263997256756, 0.02992314286530018, 0.021433331072330475}, {0.023226365447044373, 0.022197557613253593, 0.025423036888241768, 0.02327394299209118, 0.02422701194882393, 0.02821265533566475, 0.03158796578645706, 0.024098800495266914}};
            
    for ( int i=0; i<3 ; i++) {
      for ( int j=0; j<8; j++) {
	LJetEff[i][j] = LJetEff_temp[i][j];
	CJetEff[i][j] = CJetEff_temp[i][j];
	BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
  
  //ZZ(20-29)
  else if ( MCsample == 20 ) {//2Q2L 
    float BJetEff_temp[3][8] = {{0.7437589764595032, 0.7766434550285339, 0.7811528444290161, 0.7889992594718933, 0.7795048952102661, 0.7561936974525452, 0.6950146555900574, 0.5780346989631653}, {0.7234152555465698, 0.7523617148399353, 0.756691038608551, 0.7506141066551208, 0.7365036010742188, 0.6819818615913391, 0.6204409003257751, 0.49056604504585266}, {0.6882832646369934, 0.7141953706741333, 0.7095732688903809, 0.6878228187561035, 0.6558091044425964, 0.6021146178245544, 0.5338512659072876, 0.5806451439857483}};
    float CJetEff_temp[3][8] = {{0.13117852807044983, 0.13166381418704987, 0.14052070677280426, 0.15242180228233337, 0.15980041027069092, 0.1674915850162506, 0.1598682552576065, 0.1135135143995285}, {0.1419726312160492, 0.14260363578796387, 0.14990554749965668, 0.15824253857135773, 0.15553703904151917, 0.15030109882354736, 0.14341776072978973, 0.10087719559669495}, {0.15103557705879211, 0.14989908039569855, 0.15333761274814606, 0.16000306606292725, 0.15602029860019684, 0.14668922126293182, 0.11950286477804184, 0.0555555559694767}};
    float LJetEff_temp[3][8] = {{0.008144854567945004, 0.008041471242904663, 0.008919689804315567, 0.011032558046281338, 0.012548730708658695, 0.015531431883573532, 0.020064322277903557, 0.020618556067347527}, {0.011977056972682476, 0.011593148112297058, 0.012747619301080704, 0.01430505607277155, 0.01606590487062931, 0.017250806093215942, 0.022176461294293404, 0.024835646152496338}, {0.018541624769568443, 0.01716974750161171, 0.018788212910294533, 0.021532081067562103, 0.021514466032385826, 0.022382812574505806, 0.028489621356129646, 0.023622047156095505}};
    
    for ( int i=0; i<3 ; i++) {
      for ( int j=0; j<8; j++) {
	LJetEff[i][j] = LJetEff_temp[i][j];
	CJetEff[i][j] = CJetEff_temp[i][j];
	BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
  else if ( MCsample == 21 ) { //2Q2Nu
    float BJetEff_temp[3][8] = {{0.7487614750862122, 0.7931034564971924, 0.8216911554336548, 0.7978339195251465, 0.75, 0.7413793206214905, 0.8461538553237915, 0.0}, {0.739098310470581, 0.7665782570838928, 0.7927565574645996, 0.7720000147819519, 0.7898550629615784, 0.8214285969734192, 0.5333333611488342, 0.0}, {0.6900647878646851, 0.7142857313156128, 0.7456140518188477, 0.7191011309623718, 0.6707317233085632, 0.6086956262588501, 0.800000011920929, 0.0}};
    float CJetEff_temp[3][8] = {{0.12862318754196167, 0.09589041024446487, 0.13300491869449615, 0.15555556118488312, 0.11666666716337204, 0.2142857164144516, 0.25, 1.0}, {0.15555556118488312, 0.10596026480197906, 0.16384181380271912, 0.1473684161901474, 0.125, 0.2142857164144516, 0.0, 0.0}, {0.14204545319080353, 0.1631578952074051, 0.12751677632331848, 0.1785714328289032, 0.1428571492433548, 0.0, 0.0, 0.0}};
    float LJetEff_temp[3][8] = {{0.01059374213218689, 0.007563479244709015, 0.007672634441405535, 0.008746355772018433, 0.009661835618317127, 0.004608294926583767, 0.020618556067347527, 0.0}, {0.013464235700666904, 0.01061173528432846, 0.014381591230630875, 0.018315019086003304, 0.014164306223392487, 0.0, 0.02380952425301075, 0.0}, {0.022647403180599213, 0.01871657744050026, 0.020434226840734482, 0.02425876073539257, 0.010256410576403141, 0.07594936341047287, 0.0357142873108387, 0.0}};
            
    for ( int i=0; i<3 ; i++) {
      for ( int j=0; j<8; j++) {
	LJetEff[i][j] = LJetEff_temp[i][j];
	CJetEff[i][j] = CJetEff_temp[i][j];
	BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
  else if ( MCsample == 22 ) { //4L
    float BJetEff_temp[3][8] = {{0.7087401151657104, 0.7511782646179199, 0.7732033133506775, 0.7784788012504578, 0.7709923386573792, 0.7246891856193542, 0.6627907156944275, 0.2222222238779068}, {0.6972038149833679, 0.7353781461715698, 0.7455878853797913, 0.73513263463974, 0.7124378085136414, 0.7027707695960999, 0.5950413346290588, 0.0}, {0.6572458148002625, 0.6847977638244629, 0.6672953367233276, 0.6728033423423767, 0.6412825584411621, 0.5424836874008179, 0.65625, 0.0}};
    float CJetEff_temp[3][8] = {{0.12247759848833084, 0.12590695917606354, 0.1363237351179123, 0.14711600542068481, 0.1598116159439087, 0.15284787118434906, 0.12603305280208588, 0.12903225421905518}, {0.13186335563659668, 0.1345103532075882, 0.14457371830940247, 0.14560602605342865, 0.15468324720859528, 0.14461538195610046, 0.10256410390138626, 0.1111111119389534}, {0.14372140169143677, 0.1453799158334732, 0.13823485374450684, 0.1465461552143097, 0.15023112297058105, 0.16166281700134277, 0.12389380484819412, 0.0}};
    float LJetEff_temp[3][8] = {{0.026861993595957756, 0.026073167100548744, 0.027378886938095093, 0.028326479718089104, 0.027173912152647972, 0.030213890597224236, 0.04428095370531082, 0.08818010985851288}, {0.03344040736556053, 0.0314575619995594, 0.033695004880428314, 0.033014360815286636, 0.033884648233652115, 0.03471256420016289, 0.04202764853835106, 0.11029411852359772}, {0.0395021066069603, 0.038156647235155106, 0.03901132941246033, 0.04061327874660492, 0.04072199761867523, 0.0431596077978611, 0.05717151612043381, 0.1627907007932663}};
            
    for ( int i=0; i<3 ; i++) {
      for ( int j=0; j<8; j++) {
	LJetEff[i][j] = LJetEff_temp[i][j];
	CJetEff[i][j] = CJetEff_temp[i][j];
	BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
  else if ( MCsample == 23 ) { //2L2Nu
    float BJetEff_temp[3][8] = {{0.7188389897346497, 0.7586630582809448, 0.768365204334259, 0.7695534229278564, 0.7564947605133057, 0.7374343872070312, 0.6685498952865601, 0.34285715222358704}, {0.7029092311859131, 0.7273309826850891, 0.7475029826164246, 0.732252836227417, 0.7132753133773804, 0.6960452198982239, 0.5850340127944946, 0.25}, {0.6730661988258362, 0.6990198493003845, 0.7039453387260437, 0.6777408719062805, 0.6643990874290466, 0.6067415475845337, 0.4591836631298065, 0.0}};
    float CJetEff_temp[3][8] = {{0.12420370429754257, 0.1244216337800026, 0.1421360969543457, 0.14425058662891388, 0.15718628466129303, 0.14116686582565308, 0.1361003816127777, 0.06060606241226196}, {0.1357804238796234, 0.1372031718492508, 0.1373579204082489, 0.14247974753379822, 0.15898160636425018, 0.14261168241500854, 0.11042945086956024, 0.0}, {0.14119192957878113, 0.14064331352710724, 0.1460006982088089, 0.15017171204090118, 0.16011729836463928, 0.1403762698173523, 0.1318681389093399, 0.0}};
    float LJetEff_temp[3][8] = {{0.010678957216441631, 0.010261218063533306, 0.010213757865130901, 0.011776242405176163, 0.012922803871333599, 0.01619979739189148, 0.01792372576892376, 0.018331805244088173}, {0.014839846640825272, 0.014553582295775414, 0.01499031949788332, 0.015543193556368351, 0.017659299075603485, 0.017344091087579727, 0.02415163628757, 0.018903592601418495}, {0.021307704970240593, 0.020676441490650177, 0.020774446427822113, 0.022915709763765335, 0.02324334718286991, 0.02404072694480419, 0.027915194630622864, 0.017241379246115685}};
            
    for ( int i=0; i<3 ; i++) {
      for ( int j=0; j<8; j++) {
	LJetEff[i][j] = LJetEff_temp[i][j];
	CJetEff[i][j] = CJetEff_temp[i][j];
	BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
  //WZ(30-39)
  else if ( MCsample == 30 ) { //2Q2L
    float BJetEff_temp[3][8] = {{0.6161103248596191, 0.6155275702476501, 0.6382494568824768, 0.6346456408500671, 0.6393616795539856, 0.642378568649292, 0.5655527114868164, 0.5643564462661743}, {0.605983555316925, 0.60643070936203, 0.6185975670814514, 0.5848690867424011, 0.6106383204460144, 0.597777783870697, 0.5483871102333069, 0.40816327929496765}, {0.5955631136894226, 0.5917481184005737, 0.5767635107040405, 0.5624468922615051, 0.559899091720581, 0.5243902206420898, 0.46315789222717285, 0.3333333432674408}};
    float CJetEff_temp[3][8] = {{0.13404129445552826, 0.13247083127498627, 0.1404384970664978, 0.1546921283006668, 0.1622510552406311, 0.16270476579666138, 0.14867271482944489, 0.08960328251123428}, {0.1473546028137207, 0.1473783701658249, 0.15037329494953156, 0.15620557963848114, 0.16339778900146484, 0.15770569443702698, 0.1354336142539978, 0.06658878177404404}, {0.1554853469133377, 0.15389017760753632, 0.15399563312530518, 0.1605757772922516, 0.16311383247375488, 0.1498364508152008, 0.130333811044693, 0.07731958478689194}};
    float LJetEff_temp[3][8] = {{0.007768641225993633, 0.00784241408109665, 0.008764972910284996, 0.01048317737877369, 0.012476553209125996, 0.014845745638012886, 0.019711436703801155, 0.021045122295618057}, {0.011492854915559292, 0.011223805136978626, 0.012378610670566559, 0.01385029498487711, 0.015620146878063679, 0.018064765259623528, 0.021625777706503868, 0.023415548726916313}, {0.018209291622042656, 0.017409201711416245, 0.01846100203692913, 0.02157725766301155, 0.02282426878809929, 0.024117369204759598, 0.02850327268242836, 0.02298850566148758}};
            
    for ( int i=0; i<3 ; i++) {
      for ( int j=0; j<8; j++) {
	LJetEff[i][j] = LJetEff_temp[i][j];
	CJetEff[i][j] = CJetEff_temp[i][j];
	BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
  else if ( MCsample == 31 ) { //3LNu
    float BJetEff_temp[3][8] = {{0.6558139324188232, 0.693581759929657, 0.7290419340133667, 0.7027601003646851, 0.6506849527359009, 0.6778242588043213, 0.5319148898124695, 0.550000011920929}, {0.6500920653343201, 0.6870653629302979, 0.6870370507240295, 0.6820651888847351, 0.6489796042442322, 0.6578947305679321, 0.5285714268684387, 0.6666666865348816}, {0.6191352605819702, 0.6271510720252991, 0.6057142615318298, 0.5885167717933655, 0.5681818127632141, 0.6000000238418579, 0.5277777910232544, 1.0}};
    float CJetEff_temp[3][8] = {{0.12455299496650696, 0.12544898688793182, 0.12837322056293488, 0.1577690988779068, 0.15930047631263733, 0.1618051677942276, 0.15651260316371918, 0.03529411926865578}, {0.1314857453107834, 0.13665908575057983, 0.1461629718542099, 0.13944901525974274, 0.15173596143722534, 0.15266558527946472, 0.11224489659070969, 0.12244898080825806}, {0.1419660747051239, 0.14072386920452118, 0.1519150286912918, 0.15629900991916656, 0.1478632539510727, 0.12318840622901917, 0.14054054021835327, 0.1111111119389534}};
    float LJetEff_temp[3][8] = {{0.022610360756516457, 0.021018965169787407, 0.020837359130382538, 0.020931225270032883, 0.020526794716715813, 0.021115222945809364, 0.02676040306687355, 0.027896996587514877}, {0.02964891493320465, 0.02743474207818508, 0.02688416838645935, 0.027602648362517357, 0.025261323899030685, 0.02610830031335354, 0.031072143465280533, 0.054644808173179626}, {0.03529464453458786, 0.03411130979657173, 0.032183583825826645, 0.03200993686914444, 0.03137281537055969, 0.028299281373620033, 0.03693181648850441, 0.04123711213469505}};
            
    for ( int i=0; i<3 ; i++) {
      for ( int j=0; j<8; j++) {
	LJetEff[i][j] = LJetEff_temp[i][j];
	CJetEff[i][j] = CJetEff_temp[i][j];
	BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
  else if ( MCsample == 32 ) { //1L1Nu2Q
    float BJetEff_temp[3][8] = {{0.6232365369796753, 0.6210227012634277, 0.5992156863212585, 0.5828933715820312, 0.5962815284729004, 0.5617284178733826, 0.5650684833526611, 0.5744680762290955}, {0.603951096534729, 0.5897260308265686, 0.5648720264434814, 0.5576158761978149, 0.578849732875824, 0.5490196347236633, 0.5027322173118591, 0.36000001430511475}, {0.5607351064682007, 0.5991735458374023, 0.5283018946647644, 0.5625, 0.5581395626068115, 0.5235294103622437, 0.46268656849861145, 0.0}};
    float CJetEff_temp[3][8] = {{0.13317033648490906, 0.1294894963502884, 0.135342538356781, 0.1476231813430786, 0.15558087825775146, 0.15922433137893677, 0.14828969538211823, 0.11376146972179413}, {0.14543986320495605, 0.14001427590847015, 0.1453411877155304, 0.15575620532035828, 0.1610022336244583, 0.1507488340139389, 0.1367693692445755, 0.09747292101383209}, {0.15317992866039276, 0.15599706768989563, 0.15488070249557495, 0.15784065425395966, 0.1564413607120514, 0.141253262758255, 0.11554799973964691, 0.09259258955717087}};
    float LJetEff_temp[3][8] = {{0.005078126210719347, 0.00570075074210763, 0.006592134479433298, 0.008279414847493172, 0.011086277663707733, 0.012754971161484718, 0.01785772293806076, 0.01953461579978466}, {0.008178440853953362, 0.00763343321159482, 0.008953086100518703, 0.010562731884419918, 0.011725539341568947, 0.014879448339343071, 0.01974915713071823, 0.02091836743056774}, {0.014848561957478523, 0.014229850843548775, 0.01502355094999075, 0.01820429041981697, 0.021463023498654366, 0.022360464558005333, 0.02340477891266346, 0.020134227350354195}};
            
    for ( int i=0; i<3 ; i++) {
      for ( int j=0; j<8; j++) {
	LJetEff[i][j] = LJetEff_temp[i][j];
	CJetEff[i][j] = CJetEff_temp[i][j];
	BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
  //WW(40-49)
  else if ( MCsample == 40 ) { //1L1Nu2Q
    float BJetEff_temp[3][8] = {{0.6037336587905884, 0.6006055474281311, 0.5984106659889221, 0.598865270614624, 0.589160144329071, 0.5884566903114319, 0.6056485176086426, 0.5}, {0.5812376737594604, 0.5948845148086548, 0.5669132471084595, 0.5733764171600342, 0.5835866332054138, 0.5555555820465088, 0.5244648456573486, 0.4375}, {0.5702241659164429, 0.5561729669570923, 0.5652472376823425, 0.5330553650856018, 0.5495049357414246, 0.565891444683075, 0.4234234094619751, 0.20000000298023224}};
    float CJetEff_temp[3][8] = {{0.13320986926555634, 0.13082943856716156, 0.13723087310791016, 0.14757204055786133, 0.15560634434223175, 0.1582401543855667, 0.1403108537197113, 0.08468244224786758}, {0.14699265360832214, 0.14341098070144653, 0.1475154459476471, 0.15187899768352509, 0.15607064962387085, 0.14874900877475739, 0.12730517983436584, 0.06857942789793015}, {0.15592853724956512, 0.15452374517917633, 0.1553124338388443, 0.16141562163829803, 0.15963652729988098, 0.14543335139751434, 0.12643678486347198, 0.08301886916160583}};
    float LJetEff_temp[3][8] = {{0.004909098148345947, 0.005334839224815369, 0.006675864569842815, 0.008254471234977245, 0.010690301656723022, 0.012417721562087536, 0.01639558933675289, 0.017288444563746452}, {0.008073711767792702, 0.007977999746799469, 0.008980079554021358, 0.01080204825848341, 0.012465772219002247, 0.013906138949096203, 0.01849847100675106, 0.01827066019177437}, {0.01506771519780159, 0.01416649017482996, 0.015450205653905869, 0.018328921869397163, 0.020161984488368034, 0.020687967538833618, 0.024951603263616562, 0.01974448375403881}};
            
    for ( int i=0; i<3 ; i++) {
      for ( int j=0; j<8; j++) {
	LJetEff[i][j] = LJetEff_temp[i][j];
	CJetEff[i][j] = CJetEff_temp[i][j];
	BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
  else if ( MCsample == 41 ) { //2L2Nu
    float BJetEff_temp[3][8] = {{0.6901528239250183, 0.7001879811286926, 0.7554786801338196, 0.75, 0.6732954382896423, 0.605042040348053, 0.6439393758773804, 0.5555555820465088}, {0.6871450543403625, 0.6926605701446533, 0.6846153736114502, 0.6453900933265686, 0.60546875, 0.604651153087616, 0.4933333396911621, 0.5454545617103577}, {0.6481223702430725, 0.693708598613739, 0.6819338202476501, 0.5714285969734192, 0.6319444179534912, 0.6708860993385315, 0.5384615659713745, 0.5}};
    float CJetEff_temp[3][8] = {{0.12177186459302902, 0.13051947951316833, 0.1347266286611557, 0.14735226333141327, 0.1527181714773178, 0.16179104149341583, 0.13630731403827667, 0.11249999701976776}, {0.1367781162261963, 0.1278863251209259, 0.1443900167942047, 0.1453729271888733, 0.14765432476997375, 0.15584415197372437, 0.1149425283074379, 0.04878048598766327}, {0.1390565037727356, 0.14822079241275787, 0.1494768261909485, 0.14951573312282562, 0.14788731932640076, 0.1488095223903656, 0.12025316804647446, 0.25}};
    float LJetEff_temp[3][8] = {{0.018091002479195595, 0.01615018956363201, 0.01508773397654295, 0.015053533017635345, 0.014516588300466537, 0.015092735178768635, 0.017690220847725868, 0.010912698693573475}, {0.023762956261634827, 0.021849824115633965, 0.02051931619644165, 0.019645169377326965, 0.019628379493951797, 0.017917972058057785, 0.020717013627290726, 0.018672199919819832}, {0.030968546867370605, 0.028851350769400597, 0.02866242080926895, 0.029027516022324562, 0.02543199621140957, 0.023407574743032455, 0.02262253873050213, 0.0}};
            
    for ( int i=0; i<3 ; i++) {
      for ( int j=0; j<8; j++) {
	LJetEff[i][j] = LJetEff_temp[i][j];
	CJetEff[i][j] = CJetEff_temp[i][j];
	BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
  else if ( MCsample == 42 ) { //4Q
    float BJetEff_temp[3][8] = {{0.6589147448539734, 0.6538461446762085, 0.5348837375640869, 0.7777777910232544, 0.3499999940395355, 0.699999988079071, 0.375, 0.0}, {0.6086956262588501, 0.6279069781303406, 0.44999998807907104, 0.3684210479259491, 0.2857142984867096, 0.7142857313156128, 0.5, 0.0}, {0.5205479264259338, 0.3928571343421936, 0.3913043439388275, 0.29411765933036804, 0.3571428656578064, 0.6666666865348816, 1.0, 0.0}};
    float CJetEff_temp[3][8] = {{0.1389278769493103, 0.13078150153160095, 0.15034694969654083, 0.14932885766029358, 0.13333334028720856, 0.13939394056797028, 0.16470588743686676, 0.0}, {0.14631232619285583, 0.141227588057518, 0.14613424241542816, 0.1645367443561554, 0.16883116960525513, 0.19672131538391113, 0.08196721225976944, 0.0}, {0.1599198430776596, 0.1704384684562683, 0.1636747568845749, 0.17374517023563385, 0.1651376187801361, 0.11627907305955887, 0.18518517911434174, 0.0}};
    float LJetEff_temp[3][8] = {{0.006167348474264145, 0.006684822961688042, 0.00805418286472559, 0.012964858673512936, 0.01536406110972166, 0.00968188140541315, 0.011396011337637901, 0.0357142873108387}, {0.009942270815372467, 0.008571428246796131, 0.010229210369288921, 0.012734082527458668, 0.013956733979284763, 0.013024602085351944, 0.02181818149983883, 0.04545454680919647}, {0.015405112877488136, 0.013567838817834854, 0.013195342384278774, 0.02037697471678257, 0.03030303120613098, 0.01534526888281107, 0.0260869562625885, 0.0}};
            
    for ( int i=0; i<3 ; i++) {
      for ( int j=0; j<8; j++) {
	LJetEff[i][j] = LJetEff_temp[i][j];
	CJetEff[i][j] = CJetEff_temp[i][j];
	BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
  //SingleTop(50-59)
  else if ( MCsample == 50 ) { //t-channel_Top_InclusiveDecays
    float BJetEff_temp[3][8] = {{0.7453923225402832, 0.7839614748954773, 0.8017751574516296, 0.8066586852073669, 0.7962760925292969, 0.7590710520744324, 0.668414294719696, 0.4229636788368225}, {0.7234241366386414, 0.7598275542259216, 0.7756466269493103, 0.7735981345176697, 0.7504380941390991, 0.6949090361595154, 0.5964202880859375, 0.37936046719551086}, {0.6880254149436951, 0.720856785774231, 0.7236635684967041, 0.7072792053222656, 0.668330192565918, 0.596500813961029, 0.4898696541786194, 0.23376622796058655}};
    float CJetEff_temp[3][8] = {{0.1272040605545044, 0.12679888308048248, 0.135970801115036, 0.1459421068429947, 0.15556080639362335, 0.15502649545669556, 0.13806913793087006, 0.11836734414100647}, {0.13795210421085358, 0.1357264220714569, 0.1416826844215393, 0.1492188721895218, 0.14883315563201904, 0.1433369219303131, 0.11962810158729553, 0.07657657563686371}, {0.1449575126171112, 0.1427597999572754, 0.14380021393299103, 0.14279060065746307, 0.1421038806438446, 0.12652891874313354, 0.10171133279800415, 0.07058823853731155}};
    float LJetEff_temp[3][8] = {{0.006259407382458448, 0.0062407199293375015, 0.007237098179757595, 0.00882802251726389, 0.010935504920780659, 0.012743600644171238, 0.014863356947898865, 0.012731481343507767}, {0.009721612557768822, 0.009063095785677433, 0.009687120094895363, 0.011189446784555912, 0.012657064013183117, 0.014853916130959988, 0.019977783784270287, 0.01797136850655079}, {0.01640334352850914, 0.015289357863366604, 0.016197726130485535, 0.018830033019185066, 0.020649684593081474, 0.02218327485024929, 0.024747628718614578, 0.018342820927500725}};
            
    for ( int i=0; i<3 ; i++) {
      for ( int j=0; j<8; j++) {
	LJetEff[i][j] = LJetEff_temp[i][j];
	CJetEff[i][j] = CJetEff_temp[i][j];
	BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
  else if ( MCsample == 51 ) { //t-channel_AntiTop_InclusiveDecays
    float BJetEff_temp[3][8] = {{0.7458001971244812, 0.7840533256530762, 0.8035733103752136, 0.8088564276695251, 0.7982115745544434, 0.7586808204650879, 0.6739083528518677, 0.44342857599258423}, {0.7242635488510132, 0.7596583366394043, 0.7778316140174866, 0.7745696306228638, 0.7498235106468201, 0.6972823143005371, 0.5962212085723877, 0.3571428656578064}, {0.6885083317756653, 0.7228468060493469, 0.7290728688240051, 0.7090185880661011, 0.668318510055542, 0.5968454480171204, 0.4910573363304138, 0.3243243098258972}};
    float CJetEff_temp[3][8] = {{0.1292373687028885, 0.12508150935173035, 0.1327240914106369, 0.1502113938331604, 0.15467585623264313, 0.16435834765434265, 0.15293771028518677, 0.050724636763334274}, {0.14110718667507172, 0.1376396268606186, 0.1451440006494522, 0.1495303213596344, 0.15512871742248535, 0.149224653840065, 0.12623168528079987, 0.061403509229421616}, {0.14704787731170654, 0.14540241658687592, 0.14791256189346313, 0.15452155470848083, 0.14936566352844238, 0.13594576716423035, 0.11708860844373703, 0.095238097012043}};
    float LJetEff_temp[3][8] = {{0.0062132952734827995, 0.006000066176056862, 0.007217702455818653, 0.009027342312037945, 0.010302947834134102, 0.012851513922214508, 0.015432260930538177, 0.015169194899499416}, {0.009543304331600666, 0.009065686725080013, 0.009640604257583618, 0.010659633204340935, 0.01207647193223238, 0.013854998163878918, 0.01660872995853424, 0.01849948614835739}, {0.01618266850709915, 0.015016906894743443, 0.015820519998669624, 0.017400864511728287, 0.019870487973093987, 0.021111538633704185, 0.023845473304390907, 0.03361344709992409}};
            
    for ( int i=0; i<3 ; i++) {
      for ( int j=0; j<8; j++) {
	LJetEff[i][j] = LJetEff_temp[i][j];
	CJetEff[i][j] = CJetEff_temp[i][j];
	BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
  else if ( MCsample == 52 ) { //s-channel_LeptonDecays
    float BJetEff_temp[3][8] = {{0.7453650236129761, 0.7828378677368164, 0.7996272444725037, 0.8035898208618164, 0.7953076958656311, 0.7579715847969055, 0.6623662114143372, 0.42154112458229065}, {0.7209283709526062, 0.7555903792381287, 0.7686336040496826, 0.7671758532524109, 0.7454239130020142, 0.6880998611450195, 0.5814264416694641, 0.3270791172981262}, {0.6844767332077026, 0.7135440111160278, 0.7174836993217468, 0.7015329003334045, 0.6656878590583801, 0.5906581878662109, 0.48201942443847656, 0.14661654829978943}};
    float CJetEff_temp[3][8] = {{0.12189842015504837, 0.12494078278541565, 0.13214978575706482, 0.1432999223470688, 0.1496429145336151, 0.13938848674297333, 0.13624678552150726, 0.07633587718009949}, {0.13158078491687775, 0.13524802029132843, 0.1372447907924652, 0.1414983719587326, 0.14966458082199097, 0.1356828212738037, 0.12893401086330414, 0.0317460335791111}, {0.13809463381767273, 0.13785137236118317, 0.13566946983337402, 0.15784476697444916, 0.14239779114723206, 0.12868048250675201, 0.07763975113630295, 0.0}};
    float LJetEff_temp[3][8] = {{0.00641588494181633, 0.006178546696901321, 0.007109819445759058, 0.008610540069639683, 0.010310975834727287, 0.012463537976145744, 0.013950588181614876, 0.01823154091835022}, {0.009950275532901287, 0.009090306237339973, 0.009376630187034607, 0.011251150630414486, 0.012361555360257626, 0.013294557109475136, 0.01743301749229431, 0.022336769849061966}, {0.017758101224899292, 0.0158001147210598, 0.016703231260180473, 0.017635133117437363, 0.017920786514878273, 0.01748843491077423, 0.02021610364317894, 0.01149425283074379}};
            
    for ( int i=0; i<3 ; i++) {
      for ( int j=0; j<8; j++) {
	LJetEff[i][j] = LJetEff_temp[i][j];
	CJetEff[i][j] = CJetEff_temp[i][j];
	BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
  else if ( MCsample == 53 ) { //tW_AntiTop_InclusiceDecays
    float BJetEff_temp[3][8] = {{0.7433643341064453, 0.7812831401824951, 0.7970994114875793, 0.8021209239959717, 0.7942695617675781, 0.7549158930778503, 0.6595141887664795, 0.3958083689212799}, {0.722005307674408, 0.7579805254936218, 0.7709589004516602, 0.7698646187782288, 0.7528563737869263, 0.6984675526618958, 0.575263261795044, 0.3152318000793457}, {0.6914396286010742, 0.7205057740211487, 0.7230164408683777, 0.7118133306503296, 0.6743512153625488, 0.6020520329475403, 0.4766097962856293, 0.3214285671710968}};
    float CJetEff_temp[3][8] = {{0.132737398147583, 0.129032701253891, 0.13928093016147614, 0.14797468483448029, 0.15995165705680847, 0.16482843458652496, 0.15162241458892822, 0.09071274101734161}, {0.14315485954284668, 0.14135952293872833, 0.15140090882778168, 0.15663166344165802, 0.160356342792511, 0.14760413765907288, 0.1281914860010147, 0.07407407462596893}, {0.15062761306762695, 0.14960114657878876, 0.15359185636043549, 0.1575726717710495, 0.1538279801607132, 0.13867047429084778, 0.1391650140285492, 0.1111111119389534}};
    float LJetEff_temp[3][8] = {{0.007477233186364174, 0.00712161511182785, 0.008095957338809967, 0.009652083739638329, 0.011194029822945595, 0.013291720300912857, 0.017500000074505806, 0.023282887414097786}, {0.011167694814503193, 0.00983788724988699, 0.010478110983967781, 0.0118954973295331, 0.013377783820033073, 0.015192675404250622, 0.020602425560355186, 0.01604278013110161}, {0.017711561173200607, 0.016335371881723404, 0.01622212864458561, 0.018280915915966034, 0.019793424755334854, 0.022549115121364594, 0.026358695700764656, 0.019480518996715546}};
            
    for ( int i=0; i<3 ; i++) {
      for ( int j=0; j<8; j++) {
	LJetEff[i][j] = LJetEff_temp[i][j];
	CJetEff[i][j] = CJetEff_temp[i][j];
	BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
  else if ( MCsample == 54 ) { //tW_Top_InclusiveDecays
    float BJetEff_temp[3][8] = {{0.745695948600769, 0.7825878858566284, 0.7968599200248718, 0.8022621870040894, 0.7929937243461609, 0.7552399635314941, 0.6586787700653076, 0.4053751528263092}, {0.7223795652389526, 0.7570238709449768, 0.7685760855674744, 0.769629955291748, 0.7500190138816833, 0.6923357844352722, 0.5867615938186646, 0.33243969082832336}, {0.6901876330375671, 0.7180486917495728, 0.7230318188667297, 0.7094036340713501, 0.6604950428009033, 0.6067754626274109, 0.45204710960388184, 0.2539682686328888}};
    float CJetEff_temp[3][8] = {{0.13250035047531128, 0.1296568065881729, 0.13789525628089905, 0.15071864426136017, 0.15911397337913513, 0.16293977200984955, 0.1489361673593521, 0.08467742055654526}, {0.14550459384918213, 0.14533992111682892, 0.14833183586597443, 0.152884379029274, 0.16028356552124023, 0.1489311158657074, 0.12291350215673447, 0.0662650614976883}, {0.15330307185649872, 0.14745615422725677, 0.15402229130268097, 0.1604590266942978, 0.15975387394428253, 0.14608234167099, 0.11198428273200989, 0.03846153989434242}};
    float LJetEff_temp[3][8] = {{0.007449502125382423, 0.006881870795041323, 0.00800007302314043, 0.009554984979331493, 0.01164037175476551, 0.014357629232108593, 0.019360816106200218, 0.02064896747469902}, {0.01101179700344801, 0.010009651072323322, 0.011022228747606277, 0.011778240092098713, 0.013096177019178867, 0.013189679943025112, 0.01750824600458145, 0.01337792631238699}, {0.017941026017069817, 0.01597568765282631, 0.01699371449649334, 0.0200158953666687, 0.021216178312897682, 0.022907160222530365, 0.025278057903051376, 0.011560693383216858}};
            
    for ( int i=0; i<3 ; i++) {
      for ( int j=0; j<8; j++) {
	LJetEff[i][j] = LJetEff_temp[i][j];
	CJetEff[i][j] = CJetEff_temp[i][j];
	BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
  //TTBar(60-69)
  else if ( MCsample == 60 ) { //SemiLeptonic
    float BJetEff_temp[3][8] = {{0.7477713227272034, 0.7826120853424072, 0.7981311082839966, 0.8040816187858582, 0.7966831922531128, 0.7568764090538025, 0.6495527029037476, 0.4331294894218445}, {0.7247388958930969, 0.757686197757721, 0.7702746987342834, 0.7705504894256592, 0.7544003129005432, 0.6998603343963623, 0.5874764323234558, 0.3705805242061615}, {0.6893443465232849, 0.7190554738044739, 0.7214866876602173, 0.7080917954444885, 0.6751347184181213, 0.606841504573822, 0.5034555196762085, 0.32550737261772156}};
    float CJetEff_temp[3][8] = {{0.1329435259103775, 0.13120467960834503, 0.1389664262533188, 0.1508268564939499, 0.16117258369922638, 0.16056403517723083, 0.1415065973997116, 0.0850658267736435}, {0.14623631536960602, 0.14359033107757568, 0.14891628921031952, 0.1562652587890625, 0.16098470985889435, 0.15353457629680634, 0.12825606763362885, 0.07031185925006866}, {0.15331770479679108, 0.15169204771518707, 0.15423844754695892, 0.15908177196979523, 0.15837109088897705, 0.14232373237609863, 0.1155843436717987, 0.057708870619535446}};
    float LJetEff_temp[3][8] = {{0.006066108588129282, 0.006013432517647743, 0.007028542924672365, 0.00866905227303505, 0.010532280430197716, 0.01227352675050497, 0.015342235565185547, 0.015587530098855495}, {0.009367981925606728, 0.008902385830879211, 0.009628941304981709, 0.010884372517466545, 0.012325684539973736, 0.013609080575406551, 0.01734832488000393, 0.01765277609229088}, {0.01660114899277687, 0.015554171055555344, 0.016361389309167862, 0.018333636224269867, 0.019995950162410736, 0.021364035084843636, 0.023725174367427826, 0.01926686242222786}};
            
    for ( int i=0; i<3 ; i++) {
      for ( int j=0; j<8; j++) {
	LJetEff[i][j] = LJetEff_temp[i][j];
	CJetEff[i][j] = CJetEff_temp[i][j];
	BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
  else if ( MCsample == 61 ) { //DiLeptonic
    float BJetEff_temp[3][8] = {{0.7457080483436584, 0.7816900610923767, 0.7982883453369141, 0.8054531812667847, 0.7996131777763367, 0.7685000896453857, 0.7088784575462341, 0.6011533141136169}, {0.7226729393005371, 0.7565244436264038, 0.7697226405143738, 0.7709077000617981, 0.7568385601043701, 0.7130463123321533, 0.6515716910362244, 0.5431314706802368}, {0.687089204788208, 0.7172317504882812, 0.7201799154281616, 0.7079634666442871, 0.6784870028495789, 0.6240714192390442, 0.5671215653419495, 0.484049916267395}};
    float CJetEff_temp[3][8] = {{0.12391655147075653, 0.12612448632717133, 0.13864271342754364, 0.15198814868927002, 0.16216717660427094, 0.1599414348602295, 0.1356346160173416, 0.08264033496379852}, {0.13229069113731384, 0.13276132941246033, 0.14079682528972626, 0.15172454714775085, 0.15829461812973022, 0.14726395905017853, 0.1215321272611618, 0.06487785279750824}, {0.13688908517360687, 0.13892009854316711, 0.1416148543357849, 0.14946183562278748, 0.1462712585926056, 0.13350562751293182, 0.10270688682794571, 0.05360133945941925}};
    float LJetEff_temp[3][8] = {{0.021313875913619995, 0.018694734200835228, 0.018332239240407944, 0.017762554809451103, 0.016795655712485313, 0.01539843250066042, 0.01582624576985836, 0.015293187461793423}, {0.025471128523349762, 0.023102493956685066, 0.022192180156707764, 0.020832857117056847, 0.018665244802832603, 0.016672251746058464, 0.017852021381258965, 0.016698215156793594}, {0.028149541467428207, 0.025978337973356247, 0.02542378567159176, 0.024958975613117218, 0.023530403152108192, 0.023046473041176796, 0.023011822253465652, 0.015311743132770061}};
            
    for ( int i=0; i<3 ; i++) {
      for ( int j=0; j<8; j++) {
	LJetEff[i][j] = LJetEff_temp[i][j];
	CJetEff[i][j] = CJetEff_temp[i][j];
	BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
  
  //HTbinnedWJets(70-79)
  else if ( MCsample == 70 ) { //Inclusive
    float BJetEff_temp[3][8] = {{0.6910994648933411, 0.7456521987915039, 0.7444089651107788, 0.755595326423645, 0.7400568127632141, 0.7124999761581421, 0.6213017702102661, 0.800000011920929}, {0.6958349943161011, 0.7125396132469177, 0.7044738531112671, 0.7097505927085876, 0.7169811129570007, 0.6640316247940063, 0.5583333373069763, 0.3333333432674408}, {0.6608450412750244, 0.7017421722412109, 0.689130425453186, 0.6516854166984558, 0.6549295783042908, 0.6203703880310059, 0.5581395626068115, 0.0}};
    float CJetEff_temp[3][8] = {{0.12648145854473114, 0.13069306313991547, 0.1416768729686737, 0.14563213288784027, 0.16431552171707153, 0.16282106935977936, 0.1305767148733139, 0.08955223858356476}, {0.1431380659341812, 0.14293384552001953, 0.14992745220661163, 0.15555556118488312, 0.15306122601032257, 0.14772726595401764, 0.1247706413269043, 0.06060606241226196}, {0.1543007493019104, 0.15130504965782166, 0.1526932716369629, 0.15585151314735413, 0.15356490015983582, 0.12538225948810577, 0.09375, 0.0}};
    float LJetEff_temp[3][8] = {{0.0055514052510261536, 0.006035327445715666, 0.006579594220966101, 0.008073939941823483, 0.009617818519473076, 0.012643530033528805, 0.01738159731030464, 0.019120458513498306}, {0.008958127349615097, 0.008453644812107086, 0.009080775082111359, 0.010379521176218987, 0.012905208393931389, 0.013172966428101063, 0.015510555356740952, 0.009999999776482582}, {0.016250981017947197, 0.014935765415430069, 0.015876494348049164, 0.01868107169866562, 0.0207980964332819, 0.021667663007974625, 0.024084294214844704, 0.017241379246115685}};
            
    for ( int i=0; i<3 ; i++) {
      for ( int j=0; j<8; j++) {
	LJetEff[i][j] = LJetEff_temp[i][j];
	CJetEff[i][j] = CJetEff_temp[i][j];
	BJetEff[i][j] = BJetEff_temp[i][j];
      }
    }
  }
  
  for (int i = 0; i < (int)Jet.size(); i++){
    float jet_prob_mc = 1.0;
    float jet_prob_data = 1.0;
    float jet_eff = 1.0;
    // choose pt bin
    int ptbin=-1;
    if     ( Jet.at(i).v.Pt() < 50  )  ptbin=0;
    else if( Jet.at(i).v.Pt() < 70  )  ptbin=1;
    else if( Jet.at(i).v.Pt() < 100 )  ptbin=2;
    else if( Jet.at(i).v.Pt() < 140 )  ptbin=3;
    else if( Jet.at(i).v.Pt() < 200 )  ptbin=4;
    else if( Jet.at(i).v.Pt() < 300 )  ptbin=5;
    else if( Jet.at(i).v.Pt() < 600 )  ptbin=6;
    else                               ptbin=7;
    // choose eta bin
    int etabin=-1;
    if      ( fabs(Jet.at(i).v.Eta()) < 0.8 ) etabin=0;
    else if ( fabs(Jet.at(i).v.Eta()) < 1.6 ) etabin=1;
    else if ( fabs(Jet.at(i).v.Eta()) < 2.4 ) etabin=2;
    else                                 continue;
    // choose flavor  
    if      ( Jet.at(i).hadronflavor == 5 ) jet_eff = BJetEff[etabin][ptbin];
    else if ( Jet.at(i).hadronflavor == 4 ) jet_eff = CJetEff[etabin][ptbin];
    else                                    jet_eff = LJetEff[etabin][ptbin];

    double SFfromPOG =  1.0;
    if( Jet.at(i).hadronflavor == 5 )
      SFfromPOG = getScaleFactors_bTagJets_MedWP_UL18(Jet.at(i).v.Eta(),Jet.at(i).v.Pt());
    else if(Jet.at(i).hadronflavor == 4 )
      SFfromPOG = getScaleFactors_cTagJets_Mis_UL18(Jet.at(i).v.Eta(),Jet.at(i).v.Pt());
    else
      SFfromPOG = getScaleFactors_LightTagJets_Mis_UL18(Jet.at(i).v.Eta(),Jet.at(i).v.Pt());
    
    // check if jet is tagged or not
    if ( Jet_btagDeepB[Jet.at(i).ind] > 0.4168){
      jet_prob_data = jet_eff*SFfromPOG;
      jet_prob_mc   = jet_eff;
    }
    else {    
      jet_prob_data = 1-jet_eff*SFfromPOG;
      jet_prob_mc   = 1-jet_eff;
    }
    
    probability_data *= jet_prob_data;
    probability_mc   *= jet_prob_mc;
  }
  
  float scaleFactor = 1.0;
  if (probability_mc > 0.0) scaleFactor = probability_data/probability_mc;
  
  return scaleFactor;
}
